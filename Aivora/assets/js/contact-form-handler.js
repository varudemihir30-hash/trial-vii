/**
 * Contact Form Handler for Google Sheets Integration
 * 
 * SETUP INSTRUCTIONS:
 * 1. Create a Google Sheet
 * 2. Create a Google Apps Script (see GOOGLE_APPS_SCRIPT.md)
 * 3. Deploy the script as a web app
 * 4. Copy the web app URL and paste it below in GOOGLE_SCRIPT_URL
 */

// ⚠️ IMPORTANT: Replace this URL with your Google Apps Script Web App URL
const GOOGLE_SCRIPT_URL = 'https://script.google.com/accounts?authuser=4&continueUrl=https%3A%2F%2Fscript.google.com%2Faccounts%3Fauthuser%3D4%26continueUrl%3Dhttps%253A%252F%252Fscript.google.com%252Faccounts%253Fauthuser%253D4%2526continueUrl%253Dhttps%25253A%25252F%25252Fscript.google.com%25252Faccounts%25253Fauthuser%25253D4%252526continueUrl%25253Dhttps%2525253A%2525252F%2525252Fscript.google.com%2525252Faccounts%2525253Fauthuser%2525253D4%25252526continueUrl%2525253Dhttps%252525253A%252525252F%252525252Fscript.google.com%252525252Faccounts%252525253Fauthuser%252525253D4%2525252526continueUrl%252525253Dhttps%25252525253A%25252525252F%25252525252Fscript.google.com%25252525252Faccounts%25252525253Fauthuser%25252525253D4%252525252526continueUrl%25252525253Dhttps%2525252525253A%2525252525252F%2525252525252Fscript.google.com%2525252525252Faccounts%2525252525253Fauthuser%2525252525253D4%25252525252526continueUrl%2525252525253Dhttps%252525252525253A%252525252525252F%252525252525252Fscript.google.com%252525252525252Faccounts%252525252525253Fauthuser%252525252525253D4%2525252525252526continueUrl%252525252525253Dhttps%25252525252525253A%25252525252525252F%25252525252525252Fscript.google.com%25252525252525252Faccounts%25252525252525253Fauthuser%25252525252525253D4%252525252525252526continueUrl%25252525252525253Dhttps%2525252525252525253A%2525252525252525252F%2525252525252525252Fscript.google.com%2525252525252525252Faccounts%2525252525252525253Fauthuser%2525252525252525253D4%25252525252525252526continueUrl%2525252525252525253Dhttps%252525252525252525253A%252525252525252525252F%252525252525252525252Fscript.google.com%252525252525252525252Faccounts%252525252525252525253Fauthuser%252525252525252525253D4%2525252525252525252526continueUrl%252525252525252525253Dhttps%25252525252525252525253A%25252525252525252525252F%25252525252525252525252Fscript.google.com%25252525252525252525252Faccounts%25252525252525252525253Fauthuser%25252525252525252525253D4%252525252525252525252526continueUrl%25252525252525252525253Dhttps%2525252525252525252525253A%2525252525252525252525252F%2525252525252525252525252Fscript.google.com%2525252525252525252525252Faccounts%2525252525252525252525253Fauthuser%2525252525252525252525253D4%25252525252525252525252526continueUrl%2525252525252525252525253Dhttps%252525252525252525252525253A%252525252525252525252525252F%252525252525252525252525252Fscript.google.com%252525252525252525252525252Faccounts%252525252525252525252525253Fauthuser%252525252525252525252525253D4%2525252525252525252525252526continueUrl%252525252525252525252525253Dhttps%25252525252525252525252525253A%25252525252525252525252525252F%25252525252525252525252525252Fscript.google.com%25252525252525252525252525252Faccounts%25252525252525252525252525253Fauthuser%25252525252525252525252525253D4%252525252525252525252525252526continueUrl%25252525252525252525252525253Dhttps%2525252525252525252525252525253A%2525252525252525252525252525252F%2525252525252525252525252525252Fscript.google.com%2525252525252525252525252525252Faccounts%2525252525252525252525252525253Fauthuser%2525252525252525252525252525253D4%25252525252525252525252525252526continueUrl%2525252525252525252525252525253Dhttps%252525252525252525252525252525253A%252525252525252525252525252525252F%252525252525252525252525252525252Fscript.google.com%252525252525252525252525252525252Faccounts%252525252525252525252525252525253Fauthuser%252525252525252525252525252525253D4%2525252525252525252525252525252526continueUrl%252525252525252525252525252525253Dhttps%25252525252525252525252525252525253A%25252525252525252525252525252525252F%25252525252525252525252525252525252Fscript.google.com%25252525252525252525252525252525252Faccounts%25252525252525252525252525252525253Fauthuser%25252525252525252525252525252525253D4%252525252525252525252525252525252526continueUrl%25252525252525252525252525252525253Dhttps%2525252525252525252525252525252525253A%2525252525252525252525252525252525252F%2525252525252525252525252525252525252Fscript.google.com%2525252525252525252525252525252525252Faccounts%2525252525252525252525252525252525253Fauthuser%2525252525252525252525252525252525253D4%25252525252525252525252525252525252526continueUrl%2525252525252525252525252525252525253Dhttps%252525252525252525252525252525252525253A%252525252525252525252525252525252525252F%252525252525252525252525252525252525252Fscript.google.com%252525252525252525252525252525252525252Foauthcallback%252525252525252525252525252525252525253Fstate%252525252525252525252525252525252525253DACjPJvHovwYCLB6Jmq73FC19RcTpZMwUonTrclv-xOdIb8MwQGynXd8_LBo-WwfyBVB7Kukb3mLerkT6xEwuipQ105sEezc564BNpANq3uGDHNjsPFIwZE4g030B3oocISvrdIkTKAKkAErOp1f3VJY_H4-DL5NQWaYGZmRJNv__1zU%2525252525252525252525252525252525252526scope%252525252525252525252525252525252525253Dhttps%25252525252525252525252525252525252525253A%25252525252525252525252525252525252525252F%25252525252525252525252525252525252525252Fwww.googleapis.com%25252525252525252525252525252525252525252Fauth%25252525252525252525252525252525252525252Fspreadsheets%2525252525252525252525252525252525252526authuser%252525252525252525252525252525252525253D4%2525252525252525252525252525252525252526prompt%252525252525252525252525252525252525253Dconsent%2525252525252525252525252525252525252526version_info%252525252525252525252525252525252525253DCmxfU1ZJX0VQbWlqLWVCMUpFREdCQWlQMDFCUlVSSVpsOXhiM1pyV2toZmRVZERRbFJXYjFWRWQwUm1NR2h2U25kVGMzTkNjRlZ4UWxoWFZXVkVZVGd6VTFCblltWkdNemhSTkVGVFUxSjVVUV8';

/**
 * Submit form data to Google Sheets via Google Apps Script
 * @param {Object} formData - Form data object
 * @returns {Promise} - Promise that resolves when submission is complete
 */
async function submitToGoogleSheets(formData) {
    if (!GOOGLE_SCRIPT_URL || GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
        throw new Error('Google Script URL not configured. Please set GOOGLE_SCRIPT_URL in contact-form-handler.js');
    }

    try {
        const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors', // Required for Google Apps Script
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        });

        // Note: With no-cors mode, we can't read the response
        // But the data will still be sent to Google Sheets
        return Promise.resolve();
    } catch (error) {
        console.error('Error submitting form:', error);
        throw error;
    }
}

// Alternative method using form submission (works better with CORS)
async function submitToGoogleSheetsWithForm(formData) {
    if (!GOOGLE_SCRIPT_URL || GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
        throw new Error('Google Script URL not configured. Please set GOOGLE_SCRIPT_URL in contact-form-handler.js');
    }

    // Create form data objectw
    const formDataToSend = new FormData();
    formDataToSend.append('name', formData.name);
    formDataToSend.append('email', formData.email);
    formDataToSend.append('phone', formData.phone);
    formDataToSend.append('service', formData.service);
    formDataToSend.append('message', formData.message);
    formDataToSend.append('file', formData.file || 'No file');

    try {
        const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            body: formDataToSend
        });

        return Promise.resolve();
    } catch (error) {
        console.error('Error submitting form:', error);
        throw error;
    }
}

// Export for use in other scripts
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { submitToGoogleSheets, submitToGoogleSheetsWithForm };
}

